{% extends 'base.html' %}
{% block title %}Pagamentos - Mirach{% endblock %}
{% block content %}
<h2 class="mb-3"><i class="fas fa-credit-card"></i> Pagamentos</h2>
<div class="row g-3">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <strong>Seu plano</strong>
        {% if subscription.trial_ends_at %}
        <span class="badge bg-warning text-dark">Trial até {{ subscription.trial_ends_at|date:"d/m/Y" }}</span>
        {% endif %}
      </div>
      <div class="card-body">
        <p class="mb-1"><strong>Atual:</strong> {{ subscription.plan.name }} ({{ subscription.plan.code }})</p>
        <p class="mb-1"><strong>Créditos:</strong> {{ credits.balance|default:0 }}</p>
        <hr>
        <form method="post">
          {% csrf_token %}
          <div class="row g-2 align-items-end">
            <div class="col-md-6">
              <label class="form-label">Mudar plano</label>
              <select name="plan" class="form-select">
                {% for p in plans %}
                <option value="{{ p.code }}" {% if p.id == subscription.plan.id %}selected{% endif %}>{{ p.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-3">
              <button type="submit" class="btn btn-primary w-100">Atualizar</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card">
      <div class="card-header"><strong>Resumo do plano</strong></div>
      <div class="card-body">
        <ul class="list-unstyled mb-0 small">
          <li><i class="fas fa-check text-success me-1"></i> Projetos: {% if subscription.plan.max_projects >= 9999 %}Ilimitados{% else %}{{ subscription.plan.max_projects }}{% endif %}</li>
          <li><i class="fas fa-check text-success me-1"></i> Datasets: {% if subscription.plan.max_datasets >= 9999 %}Ilimitados{% else %}{{ subscription.plan.max_datasets }}{% endif %}</li>
          <li><i class="fas fa-check text-success me-1"></i> Linhas por dataset: {{ subscription.plan.max_rows_per_dataset|default:"50k" }}</li>
          <li><i class="fas fa-check text-success me-1"></i> Previsões/mês: {{ subscription.plan.monthly_predictions }}</li>
          <li><i class="fas fa-bolt text-warning me-1"></i> Prioridade: {{ subscription.plan.priority }}</li>
          <li><i class="fas fa-robot text-muted me-1"></i> Modelos avançados: {% if subscription.plan.includes_advanced_models %}Sim{% else %}Não{% endif %}</li>
          <li><i class="fas fa-redo text-muted me-1"></i> Backtesting: {% if subscription.plan.includes_backtesting %}Sim{% else %}Não{% endif %}</li>
          <li><i class="fas fa-file-export text-muted me-1"></i> Exportações: {% if subscription.plan.includes_exports %}Sim{% else %}Não{% endif %}</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}


